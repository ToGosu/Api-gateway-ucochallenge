# Configuración principal de ModSecurity
# Modo detección (DetectionOnly) - no bloquea, solo registra

# Incluir reglas base de OWASP Core Rule Set (CRS)
Include /etc/nginx/modsec/crs-setup.conf
Include /etc/nginx/modsec/rules/*.conf

# Configuración básica de ModSecurity
SecRuleEngine DetectionOnly
SecRequestBodyAccess On
SecResponseBodyAccess On
SecResponseBodyMimeType text/plain text/html text/xml application/json
SecAuditEngine RelevantOnly
SecAuditLogParts ABIJDEFHZ
SecAuditLogType Serial
SecAuditLog /var/log/nginx/modsec_audit.log

# Deshabilitar reglas problemáticas para APIs REST (opcional)
# SecRuleRemoveById 942100
# SecRuleRemoveById 942200

